<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Infers Ecological Interaction Networks from Abundance
    Data • EMtree</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Infers Ecological Interaction Networks from Abundance
    Data">
<meta property="og:description" content="Uses averages over spanning trees within a Poisson
    log-Normal Model.  Involves plotting functionalities.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">EMtree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="emtree" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#emtree" class="anchor"></a>EMtree</h1></div>

<blockquote>
<p>EMtree infers interaction networks from abundance data. It uses averages over spanning trees within a Poisson log-Normal Model (<a href="https://github.com/jchiquet/PLNmodels%3E">PLNmodels</a>), and involves plotting funcitonalities (using <code>ggraph</code> and <code>tydigraph</code>).</p>
</blockquote>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the development version of EMtree:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"Rmomal/EMtree"</span>)</a></code></pre></div>
</div>
<div id="example-with-fatala-river-fishes" class="section level2">
<h2 class="hasAnchor">
<a href="#example-with-fatala-river-fishes" class="anchor"></a>Example with Fatala river fishes</h2>
<p>This is a basic example which shows you how to infer a network, using Barans95 data from the <code>ade4</code> package.</p>
<div id="data" class="section level3">
<h3 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ade4)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(baran95)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">counts =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(baran95<span class="op">$</span>fau)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">covar =<span class="st"> </span><span class="kw">as_tibble</span>(baran95<span class="op">$</span>plan)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">n =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(counts)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">p =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(counts)</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(counts)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt;   AMA CAS CHI CHL CJO CST CTR CWA CYS DAF EFI ELA GDE GME HFA HFO IAF LFA</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; 1   0   2   0   3   0   0   0   0   0   0  71   1   5   6   0   0   7   3</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; 2   0   1   0   0   0   0   0   0   0   0 118   2   3   0   0   0   8   1</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; 3   0   2   0   3   0   0   0   0   0   0  69   0   6   2   0   0   8   3</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; 4   0   0   0   2   0   0   0   0   0   0  56   0   0   0   0   0   1   0</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; 5   0   0   0   0   0   0   0   0   3   0   0   1   1   0   0   0   2   2</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; 6   0   0   0   0   0   0   0   0   5   0   0   0   2   0   0   0   0   0</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt;   LGR LNI PAA PBR PEL PJU PLE PMO POQ PPA PQQ PTY SEB TIN TLE</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; 1   3   0   0   5   2   9  26   0   4   0   0   0  22   0   2</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; 2   7   0   0   0   0   0 113   0   1   0   0   1  18   0   1</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; 3   0   0   0   1   0   3   0   0   1   0   0   0   3   0   0</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; 4   2   0   0   0   0   0   0   0   0   0   0   0  15   0   0</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; 5   5   0   0   0   3   0   0   0   4   0   0   3   0   0   0</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; 6   9   0   0   2   4   4   0   2   0   0   0   1   0   0   0</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(covar)</a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt; # A tibble: 6 x 2</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt;   date  site </span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt;   &lt;fct&gt; &lt;fct&gt;</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt; 1 apr93 km03 </span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt; 2 apr93 km03 </span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt; 3 apr93 km03 </span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt; 4 apr93 km03 </span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt; 5 apr93 km17 </span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt; 6 apr93 km17</span></a></code></pre></div>
</div>
<div id="fit-pln-model" class="section level3">
<h3 class="hasAnchor">
<a href="#fit-pln-model" class="anchor"></a>Fit PLN model</h3>
<p>This creates a <code>PLNmodels</code> object</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(PLNmodels)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">model&lt;-<span class="kw"><a href="https://rdrr.io/pkg/PLNmodels/man/PLN.html">PLN</a></span>(counts <span class="op">~</span><span class="st"> </span>covar<span class="op">$</span>site)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt;  Initialization...</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt;  Adjusting a PLN model with full covariance model</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt;  Post-treatments...</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;  DONE!</span></a></code></pre></div>
</div>
<div id="run-emtree-function" class="section level3">
<h3 class="hasAnchor">
<a href="#run-emtree-function" class="anchor"></a>Run EMtree function</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(EMtree)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">output&lt;-<span class="kw"><a href="reference/EMtree.html">EMtree</a></span>(model,  <span class="dt">maxIter =</span> <span class="dv">10</span>, <span class="dt">plot=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; [1] 0.7157895</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; Likelihoods: 81.60106 , 81.68395 , 81.684 ,</span></a></code></pre></div>
<p><img src="reference/figures/README-output-1.png" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; Convergence took 0.64 secs  and  3  iterations.</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; Likelihood difference = 5.399854e-05 </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; Betas difference = 2.305752e-09</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(output)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; List of 6</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt;  $ edges_prob  : num [1:33, 1:33] 0.00 6.78e-05 3.17e-03 7.09e-02 2.84e-03 ...</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt;  $ edges_weight: num [1:33, 1:33] 0 0.000946 0.000946 0.000947 0.000946 ...</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt;  $ logpY       : num [1:3] 81.6 81.7 81.7</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt;  $ maxIter     : num 3</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt;  $ timeEM      : 'difftime' num 0.642226934432983</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt;   ..- attr(*, "units")= chr "secs"</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt;  $ alpha       : num 0.716</span></a></code></pre></div>
</div>
<div id="foster-robustness-with-resampling" class="section level3">
<h3 class="hasAnchor">
<a href="#foster-robustness-with-resampling" class="anchor"></a>Foster robustness with resampling :</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(parallel)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">resample_output&lt;-<span class="kw"><a href="reference/ResampleEMtree.html">ResampleEMtree</a></span>(<span class="dt">counts=</span>counts, <span class="dt">covar_matrix =</span> covar<span class="op">$</span>site , <span class="dt">S=</span><span class="dv">5</span>, <span class="dt">maxIter=</span><span class="dv">10</span>,<span class="dt">cond.tol=</span><span class="fl">1e-8</span>, <span class="dt">cores=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; S= 1  [1] 0.7236842</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; Convergence took 0.23 secs  and  5  iterations.  0.7236842</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; S= 2  [1] 0.6052632</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; Convergence took 0.16 secs  and  3  iterations.  0.6052632</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; S= 3  [1] 0.6973684</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; Convergence took 0.32 secs  and  7  iterations.  0.6973684</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; S= 4  [1] 0.7894737</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; Convergence took 0.13 secs  and  3  iterations.  0.7894737</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; S= 5  [1] 0.8815789</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt; Convergence took 0.26 secs  and  6  iterations.  0.8815789</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(resample_output)</a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt; List of 3</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt;  $ Pmat   : num [1:5, 1:528] 3.86e-03 5.74e-03 4.27e-04 5.08e-05 2.41e-05 ...</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt;  $ maxIter: num [1:5] 5 3 7 3 6</span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt;  $ times  : 'difftime' num [1:5] 0.230384111404419 0.160486936569214 0.315670013427734 0.13437294960022 ...</span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt;   ..- attr(*, "units")= chr "secs"</span></a></code></pre></div>
</div>
<div id="several-models-with-resampling" class="section level3">
<h3 class="hasAnchor">
<a href="#several-models-with-resampling" class="anchor"></a>Several models with resampling :</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(parallel)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">tested_models=<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"date"</span>,<span class="st">"site"</span>,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"date"</span>,<span class="st">"site"</span>))</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">models_names=<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"date"</span>,<span class="st">"site"</span>,<span class="st">"date + site"</span>)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">compare_output&lt;-<span class="kw"><a href="reference/ComparEMtree.html">ComparEMtree</a></span>(counts, <span class="dt">covar_matrix=</span>covar, <span class="dt">models=</span>tested_models, <span class="dt">m_names=</span>models_names, <span class="dt">Pt=</span><span class="fl">0.15</span>,  <span class="dt">S=</span><span class="dv">3</span>, <span class="dt">maxIter=</span><span class="dv">5</span>,<span class="dt">cond.tol=</span><span class="fl">1e-8</span>,<span class="dt">cores=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; model  date</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; S= 1  [1] 0.2894737</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; Convergence took 0.24 secs  and  5  iterations.  0.2894737</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; S= 2  [1] 0.2763158</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; Convergence took 0.19 secs  and  4  iterations.  0.2763158</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; S= 3  [1] 0.2368421</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt; Convergence took 0.24 secs  and  5  iterations.  0.2368421</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt; model  site</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt; S= 1  [1] 0.7236842</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt; Convergence took 0.21 secs  and  5  iterations.  0.7236842</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt; S= 2  [1] 0.6052632</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#&gt; Convergence took 0.14 secs  and  3  iterations.  0.6052632</span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt; S= 3  [1] 0.6973684</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#&gt; Convergence took 0.21 secs  and  5  iterations.  0.6973684</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#&gt; model  date + site</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#&gt; S= 1  [1] 0.9473684</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="co">#&gt; Convergence took 0.22 secs  and  5  iterations.  0.9473684</span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co">#&gt; S= 2  [1] 0.9868421</span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="co">#&gt; Convergence took 0.21 secs  and  5  iterations.  0.9868421</span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co">#&gt; S= 3  [1] 0.9868421</span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co">#&gt; Convergence took 0.21 secs  and  5  iterations.  0.9868421</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(compare_output)</a>
<a class="sourceLine" id="cb8-38" data-line-number="38"><span class="co">#&gt; Classes 'tbl_df', 'tbl' and 'data.frame':    1584 obs. of  4 variables:</span></a>
<a class="sourceLine" id="cb8-39" data-line-number="39"><span class="co">#&gt;  $ node1 : chr  "2" "3" "3" "4" ...</span></a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="co">#&gt;  $ node2 : chr  "1" "1" "2" "1" ...</span></a>
<a class="sourceLine" id="cb8-41" data-line-number="41"><span class="co">#&gt;  $ model : chr  "date" "date" "date" "date" ...</span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="co">#&gt;  $ weight: num  0 0 0 0 0 ...</span></a></code></pre></div>
</div>
<div id="graphics" class="section level3">
<h3 class="hasAnchor">
<a href="#graphics" class="anchor"></a>Graphics</h3>
<div id="from-emtree-output" class="section level4">
<h4 class="hasAnchor">
<a href="#from-emtree-output" class="anchor"></a>From <code>EMtree</code> output</h4>
<p>Simple network:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggraph)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidygraph)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(viridis)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">200</span>)</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">edges_prob&lt;-<span class="st"> </span>output<span class="op">$</span>edges_prob</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">edges_prob[edges_prob<span class="op">&lt;</span><span class="dv">2</span><span class="op">/</span>p]&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="kw"><a href="reference/draw_network.html">draw_network</a></span>(edges_prob,<span class="dt">title=</span><span class="st">"Site"</span>, <span class="dt">pal=</span><span class="st">"dodgerblue3"</span>, <span class="dt">layout=</span><span class="st">"nicely"</span>,<span class="dt">curv=</span><span class="fl">0.1</span>)<span class="op">$</span>G</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" style="display: block; margin: auto;"></p>
</div>
<div id="from-resampleemtree-output" class="section level4">
<h4 class="hasAnchor">
<a href="#from-resampleemtree-output" class="anchor"></a>From <code>ResampleEMtree</code> output</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">df&lt;-<span class="kw"><a href="reference/freq_selec.html">freq_selec</a></span>(resample_output<span class="op">$</span>Pmat,<span class="dt">Pt=</span><span class="dv">2</span><span class="op">/</span>p<span class="fl">+0.1</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="kw"><a href="reference/draw_network.html">draw_network</a></span>(df,<span class="st">"Site"</span>, <span class="dt">layout=</span><span class="st">"nicely"</span>)<span class="op">$</span>G</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">df[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(df<span class="op">&lt;</span><span class="fl">1e-6</span>)]=<span class="dv">0</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw"><a href="reference/draw_network.html">draw_network</a></span>(df,<span class="st">"Site"</span>, <span class="dt">layout=</span><span class="st">"nicely"</span>)<span class="op">$</span>G</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-2.png" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="reference/draw_network.html">draw_network</a></span>(df,<span class="st">"Site"</span>, <span class="dt">layout=</span><span class="st">"nicely"</span>)<span class="op">$</span>graph_data</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt; # A tbl_graph: 33 nodes and 88 edges</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt; #</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&gt; # An undirected simple graph with 1 component</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; #</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt; # Node Data: 33 x 8 (active)</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt;     btw bool_btw bool_deg   deg title  name label finalcolor</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt;   &lt;dbl&gt; &lt;lgl&gt;    &lt;lgl&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;lgl&gt;     </span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; 1  27.8 FALSE    TRUE         8 Site      1 ""    FALSE     </span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; 2  34.5 FALSE    TRUE         4 Site      2 ""    FALSE     </span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; 3   0   FALSE    TRUE         2 Site      3 ""    FALSE     </span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; 4   0   FALSE    TRUE         4 Site      4 ""    FALSE     </span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; 5   0   FALSE    TRUE         3 Site      5 ""    FALSE     </span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt; 6  28.5 FALSE    TRUE         4 Site      6 ""    FALSE     </span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">#&gt; # … with 27 more rows</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co">#&gt; #</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="co">#&gt; # Edge Data: 88 x 6</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="co">#&gt;    from    to weight btw.weights neibs title</span></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;       &lt;dbl&gt; &lt;lgl&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="co">#&gt; 1     1     4    0.2         5   FALSE Site </span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"><span class="co">#&gt; 2     1     7    0.4         2.5 FALSE Site </span></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="co">#&gt; 3     1     8    0.2         5   FALSE Site </span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="co">#&gt; # … with 85 more rows</span></a></code></pre></div>
</div>
<div id="facet-for-plotting-several-models-in-one-shot" class="section level4">
<h4 class="hasAnchor">
<a href="#facet-for-plotting-several-models-in-one-shot" class="anchor"></a>Facet for plotting several models in one shot</h4>
<p>Comparing network by eye is difficult. In particular, choosing the right layout to do so is often troublesome. Here by default, the circle layout is used so that differences in density are easily seen.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="reference/compar_graphs.html">compar_graphs</a></span>(compare_output,<span class="dt">alpha=</span><span class="ot">TRUE</span>)<span class="op">$</span>G</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; Using `nicely` as default layout</span></a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" style="display: block; margin: auto;"></p>
<p>However, the user can decide another layout. The nodes position is preserved along the networks.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="reference/compar_graphs.html">compar_graphs</a></span>(compare_output,<span class="dt">alpha=</span><span class="ot">FALSE</span>, <span class="dt">layout=</span><span class="st">"nicely"</span>, <span class="dt">curv=</span><span class="fl">0.1</span>, <span class="dt">base_model=</span><span class="st">"site"</span>)<span class="op">$</span>G</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt; Using `nicely` as default layout</span></a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Raphaëlle Momal <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/Rmomal/EMtree"><img src="https://travis-ci.org/Rmomal/EMtree.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://codecov.io/gh/Rmomal/EMtree?branch=master"><img src="https://codecov.io/gh/Rmomal/EMtree/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/166967948"><img src="https://zenodo.org/badge/166967948.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Raphaëlle Momal.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
